from fastapi import FastAPI, HTTPException
import json
from pathlib import Path

# Create FastAPI app
app = FastAPI(title="Customer API")

# Path to our JSON file (acts like a database)
CUSTOMERS_FILE = Path("customers.json")

# Function to load customer data
def load_customers():
    with open(CUSTOMERS_FILE) as f:
        return json.load(f)

# ---- ENDPOINT 1: List all customers ----
@app.get("/customers")
def list_customers():
    return load_customers()

# ---- ENDPOINT 2: Get one customer by ID ----
@app.get("/customers/{customer_id}")
def get_customer(customer_id: int):
    customers = load_customers()
    for customer in customers:
        if customer["id"] == customer_id:
            return customer
    raise HTTPException(status_code=404, detail="Customer not found")
